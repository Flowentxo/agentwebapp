# =============================================================================
# FLOWENT AI PLATFORM - Production Environment Configuration
# =============================================================================
# IMPORTANT: Copy this file to .env.production and fill in all values
# NEVER commit .env.production to version control!
#
# Generate secrets with:
#   openssl rand -base64 64   # For JWT secrets
#   openssl rand -hex 32      # For encryption key
# =============================================================================

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
NODE_ENV=production
APP_VERSION=3.0.0

# Public URLs (used in emails, OAuth callbacks, etc.)
APP_URL=https://flowent.ai
CORS_ORIGIN=https://flowent.ai
TRUSTED_DOMAINS=flowent.ai,api.flowent.ai

# Server Ports
NEXT_PORT=3000
BACKEND_PORT=4000

# =============================================================================
# NEXT.JS PUBLIC VARIABLES (Baked into frontend at build time)
# =============================================================================
NEXT_PUBLIC_APP_URL=https://flowent.ai
NEXT_PUBLIC_API_URL=https://api.flowent.ai
NEXT_PUBLIC_WS_URL=wss://api.flowent.ai
NEXT_PUBLIC_SENTRY_DSN=

# =============================================================================
# DATABASE (PostgreSQL 16 with pgvector)
# =============================================================================
POSTGRES_USER=flowent
POSTGRES_PASSWORD=CHANGE_ME_STRONG_DB_PASSWORD_HERE
POSTGRES_DB=flowent_production
POSTGRES_PORT=5432

# Full connection string
# For Docker internal network: postgresql://flowent:PASSWORD@postgres:5432/flowent_production
DATABASE_URL=postgresql://flowent:CHANGE_ME_STRONG_DB_PASSWORD_HERE@postgres:5432/flowent_production?sslmode=disable

# =============================================================================
# REDIS (Cache & Job Queue)
# =============================================================================
REDIS_PASSWORD=CHANGE_ME_STRONG_REDIS_PASSWORD_HERE
REDIS_PORT=6379

# Full connection string
# For Docker internal network: redis://:PASSWORD@redis:6379
REDIS_URL=redis://:CHANGE_ME_STRONG_REDIS_PASSWORD_HERE@redis:6379

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# JWT Secrets - Generate with: openssl rand -base64 64
JWT_SECRET=GENERATE_A_SECURE_64_BYTE_BASE64_SECRET_HERE
JWT_REFRESH_SECRET=GENERATE_ANOTHER_SECURE_64_BYTE_BASE64_SECRET_HERE
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Encryption key for sensitive data - Generate with: openssl rand -hex 32
ENCRYPTION_KEY=GENERATE_A_32_BYTE_HEX_KEY_HERE

# Session secret - Generate with: openssl rand -base64 32
SESSION_SECRET=GENERATE_A_SESSION_SECRET_HERE

# =============================================================================
# API KEY MANAGEMENT (v3.0)
# =============================================================================
# API keys are hashed with SHA256 and stored securely
# Format: flwnt_live_<32_random_bytes_base64url>
# No additional salt needed - keys are cryptographically random

# =============================================================================
# AI CONFIGURATION (OpenAI / Compatible APIs)
# =============================================================================
# OpenAI API Key (required)
OPENAI_API_KEY=sk-your-openai-api-key-here

# Optional: Override base URL for Azure OpenAI, LocalAI, or Ollama
OPENAI_BASE_URL=

# Model Configuration
OPENAI_MODEL=gpt-4o-mini
EMBEDDING_MODEL=text-embedding-3-small

# Generation Parameters
AI_TEMPERATURE=0.7
AI_MAX_TOKENS=4000
AI_MAX_CONTEXT_TOKENS=8000
AI_PRESENCE_PENALTY=0.6
AI_FREQUENCY_PENALTY=0.5

# Retry & Timeout Configuration
AI_MAX_RETRIES=3
AI_RETRY_DELAY=1000
AI_REQUEST_TIMEOUT=60000

# Rate Limiting (per user)
AI_RATE_LIMIT_RPM=60
AI_RATE_LIMIT_TPM=100000

# Cost Tracking (per 1K tokens in USD)
AI_COST_INPUT=0.00015
AI_COST_OUTPUT=0.0006

# Feature Flags
AI_ENABLE_STREAMING=true
AI_ENABLE_TOOLS=true
AI_VERBOSE_LOGGING=false

# Optional: Anthropic API (for Claude models)
ANTHROPIC_API_KEY=

# =============================================================================
# VOICE MODE (Flowent Horizon)
# =============================================================================
# OpenAI TTS Voice Configuration
TTS_MODEL=tts-1
TTS_VOICE=alloy
TTS_SPEED=1.0

# Whisper STT Configuration
STT_MODEL=whisper-1
STT_LANGUAGE=en

# Voice Session Settings
VOICE_SESSION_TIMEOUT=300000
VOICE_MAX_AUDIO_SIZE=10485760

# =============================================================================
# EMAIL SERVICE (Resend)
# =============================================================================
RESEND_API_KEY=re_your_resend_api_key_here
EMAIL_FROM=Flowent AI <noreply@flowent.ai>
EMAIL_SUPPORT=support@flowent.ai

# =============================================================================
# INTEGRATIONS
# =============================================================================
# Slack
SLACK_WEBHOOK_URL=
SLACK_BOT_TOKEN=

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=https://flowent.ai/api/oauth/google/callback

# HubSpot
HUBSPOT_CLIENT_ID=
HUBSPOT_CLIENT_SECRET=
HUBSPOT_REDIRECT_URI=https://flowent.ai/api/oauth/hubspot/callback

# Tavily (AI Search)
TAVILY_API_KEY=

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Sentry
SENTRY_DSN=
SENTRY_ORG=your-org
SENTRY_PROJECT=flowent-ai

# Logging
LOG_LEVEL=info

# =============================================================================
# CLOUD STORAGE (Optional - AWS S3)
# =============================================================================
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=eu-central-1
S3_BUCKET=flowent-production

# =============================================================================
# PAYMENTS (Optional - Stripe)
# =============================================================================
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_ID_PRO=
STRIPE_PRICE_ID_ENTERPRISE=

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=500
AI_RATE_LIMIT_PER_MINUTE=20

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================
# Set to true on first deployment to run migrations
RUN_MIGRATIONS=false

# =============================================================================
# SECURITY CHECKLIST (Before Going to Production)
# =============================================================================
# [ ] All passwords are strong and unique (use password generator)
# [ ] JWT secrets are at least 64 bytes and randomly generated
# [ ] ENCRYPTION_KEY is 32 bytes hex (64 characters)
# [ ] DATABASE_URL uses SSL in production (sslmode=require)
# [ ] CORS_ORIGIN is set to your exact domain
# [ ] OPENAI_API_KEY is set and has appropriate rate limits
# [ ] Email service (Resend) is configured
# [ ] Sentry is configured for error tracking
# [ ] Backup strategy is in place for PostgreSQL
# [ ] SSL/TLS certificates are configured (use Let's Encrypt)
# [ ] Firewall rules block direct access to DB/Redis ports
